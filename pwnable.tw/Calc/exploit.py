"""
main:
 bsd_signal( 0xe, 0x8049434 )
 alarm( 0x3c )
 _IO_puts( 0x80bf81c )
 _IO_fflush( *0x80ec4c0 )
 calc()
 _IO_PUTS( 0x80bf842 )

calc:
ebp-0x5a0: buffer
ebp-0x40c: organized_expr
ebp-0x0c: canary



get_expr( expr, size=400 ): bufferに'\n', '+', '-', '*', '/', '%', '1' < '9'の数字を入れ込む。この記号・数字以外は無視される
 ebp-0xc => counter
 read( stdin, ebp-0xd, 1 )zh
 '\n', '+', '-', '*', '/', '%',以外かつ'1' < x < '9'である
   counter++;
   
init_pool( buffer ): 4byteずつ、0x18CByte分（0x63*4)０で埋める
[eax + edx*4 + 4]
eax: 文字変数の先頭アドレス
edx: i

parse_expr( organized_expr, buffer ):
    ebp-0x8c: organized_expr
    ebp-0x90: buffer
    ebp-0x




"""

from pwn import *

elf = ELF('./calc')

payload = b''
